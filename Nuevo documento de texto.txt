-- CREACIÃ“N DE LAS TABLAS
CREATE TABLE persona
(
   IDPER INT GENERATED BY DEFAULT ON NULL AS IDENTITY START WITH 200 INCREMENT BY 1,
   DNIPER CHAR(8),
   NOMPER VARCHAR2(60),
   APEPER VARCHAR2(80),
   EMAPER VARCHAR2(80),
   CELPER CHAR(9),
   TIPPER CHAR(1),
   ESTPER CHAR(1) DEFAULT 'A',
   FECNACPER DATE,
   CONSTRAINT PER_PK PRIMARY KEY (IDPER)
);
COMMIT;

CREATE TABLE venta
(
    IDVEN INT GENERATED BY DEFAULT ON NULL AS IDENTITY START WITH 1 INCREMENT BY 1,
    FECVEN DATE,
    IDVEND INT,
    IDCLI INT,
    TIPPAGVEN CHAR(1),
    ESTVEN CHAR(1) DEFAULT 'A',
    CONSTRAINT VEN_PK PRIMARY KEY (IDVEN)
);
COMMIT;

CREATE TABLE venta_detalle
(
    IDVENDET INT GENERATED BY DEFAULT ON NULL AS IDENTITY START WITH 300 INCREMENT BY 1,
    IDVEN INT,
    CODPROD CHAR(3),
    CANVENDET INT,
    CONSTRAINT VEND_PK PRIMARY KEY (IDVENDET)
);
COMMIT;

CREATE TABLE producto
(
    CODPROD CHAR(3),
    NOMPRO VARCHAR2(50),
    IDCAT INT,
    PREPRO NUMBER(8,2),
    STOCKPRO INT,
    ESTPRO CHAR(1) DEFAULT 'A',
    CONSTRAINT PRO_PK PRIMARY KEY (CODPROD)
);
COMMIT;

CREATE TABLE categoria
(
    IDCAT INT GENERATED BY DEFAULT ON NULL AS IDENTITY START WITH 10 INCREMENT BY 10,
    NOMCAT VARCHAR2(60),
    CONSTRAINT CAT_PK PRIMARY KEY (IDCAT)
);
COMMIT;

-- RELACIONES
ALTER TABLE venta
    ADD CONSTRAINT FK_VENTA_VENDEDOR
    FOREIGN KEY (IDVEND)
    REFERENCES persona(IDPER)
    ON DELETE CASCADE;
COMMIT;

ALTER TABLE venta
    ADD CONSTRAINT FK_VENTA_CLIENTE
    FOREIGN KEY (IDCLI)
    REFERENCES persona(IDPER)
    ON DELETE CASCADE;
COMMIT;

ALTER TABLE venta_detalle
    ADD CONSTRAINT FK_VENTA_DETALLE_VENTA
    FOREIGN KEY (IDVEN)
    REFERENCES venta(IDVEN)
    ON DELETE CASCADE;
COMMIT;

ALTER TABLE venta_detalle
    ADD CONSTRAINT FK_VENTA_DETALLE_PRODUCTO
    FOREIGN KEY (CODPROD)
    REFERENCES producto(CODPROD)
    ON DELETE CASCADE;
COMMIT;

ALTER TABLE producto
    ADD CONSTRAINT FK_PRODUCTO_CATEGORIA
    FOREIGN KEY (IDCAT)
    REFERENCES categoria(IDCAT)
    ON DELETE CASCADE;
COMMIT;